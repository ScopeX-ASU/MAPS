[38;21m2024-08-24 13:19:31,204 - train.py[line:79] - INFO: running command ['python3', 'train_metalens.py', 'configs/metalens/local_search/train_local_search/train.yml', '--criterion.aux_output_weight=0', '--aux_criterion.curl_loss.weight=0', '--aux_criterion.gap_loss.weight=0', '--plot.dir_name=metalens_train_local_search_0', '--optimizer.lr=0.0005', '--optimizer.name=adam', '--lr_scheduler.lr_min=5e-06', '--sharp_scheduler.init_sharp=10', '--sharp_scheduler.final_sharp=15', '--res_scheduler.init_res=20', '--res_scheduler.final_res=20', '--res_scheduler.test_res=20', '--run.gpu_id=0', '--run.n_epochs=15', '--run.random_state=59', '--run.fp16=False', '--model.name=Metalens', '--model.adjoint_mode=fdtd', '--model.mfs=0.3', '--model.build_method=periodic_ridge', '--model.max_num_ridges_single_side=50', '--model.initial_point=Si_metalens1D_for_850nm_FL60um.mat', '--model.binary_projection_threshold=20', '--model.subpx_smoothing_res=1000', '--model.if_constant_period=True', '--model.focal_constant=1', '--checkpoint.comment=put_your_comment_here', '--plot.train=True', '--plot.test=True', '--plot.valid=True', '--plot.output_video=False', '--plot.solve_cw=False', '--plot.phase_profile=True', '--plot.intensity_profile=True', '--plot.phase_intensity_profile_interval=5'][0m
[38;21m2024-08-24 13:40:43,239 - train.py[line:94] - INFO: Exp: metalens_local_search Done.[0m
[38;21m2024-08-24 22:57:54,286 - train.py[line:79] - INFO: running command ['python3', 'train_metalens.py', 'configs/metalens/local_search/train_local_search/train.yml', '--criterion.aux_output_weight=0', '--aux_criterion.curl_loss.weight=0', '--aux_criterion.gap_loss.weight=0', '--plot.dir_name=metalens_train_local_search_0', '--optimizer.lr=0.0005', '--optimizer.name=adam', '--lr_scheduler.lr_min=5e-06', '--sharp_scheduler.init_sharp=10', '--sharp_scheduler.final_sharp=15', '--res_scheduler.init_res=20', '--res_scheduler.final_res=20', '--res_scheduler.test_res=20', '--run.gpu_id=0', '--run.n_epochs=15', '--run.random_state=59', '--run.fp16=False', '--model.name=Metalens', '--model.adjoint_mode=fdtd', '--model.mfs=0.3', '--model.build_method=periodic_ridge', '--model.max_num_ridges_single_side=50', '--model.initial_point=Si_metalens1D_for_850nm_FL60um.mat', '--model.binary_projection_threshold=20', '--model.subpx_smoothing_res=1000', '--model.if_constant_period=True', '--model.focal_constant=1', '--checkpoint.comment=put_your_comment_here', '--plot.train=True', '--plot.test=True', '--plot.valid=True', '--plot.output_video=False', '--plot.solve_cw=False', '--plot.phase_profile=True', '--plot.intensity_profile=True', '--plot.phase_intensity_profile_interval=5'][0m
Process ForkPoolWorker-3:
Process ForkPoolWorker-2:
Process ForkPoolWorker-4:
Traceback (most recent call last):
  File "/home/pingchua/projects/Metasurface-Opt/scripts/robust_inverse_design/metalens/train.py", line 93, in <module>
    p.map(task_launcher, tasks)
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 367, in map
    return self._map_async(func, iterable, mapstar, chunksize).get()
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 768, in get
    self.wait(timeout)
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 765, in wait
    self._event.wait(timeout)
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/threading.py", line 607, in wait
    signaled = self._cond.wait(timeout)
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt
[38;21m2024-09-27 18:05:01,268 - train.py[line:91] - INFO: running command ['python3', 'train_metacoupler.py', 'configs/metacoupler/local_search/train_local_search/train.yml', '--criterion.aux_output_weight=0', '--aux_criterion.curl_loss.weight=0', '--aux_criterion.gap_loss.weight=0', '--aux_criterion.aspect_ratio_loss.weight=0', '--plot.dir_name=metacoupler_train_local_search_1', '--optimizer.lr=0.002', '--optimizer.name=adam', '--lr_scheduler.lr_min=2e-05', '--sharp_scheduler.init_sharp=4', '--sharp_scheduler.final_sharp=20', '--res_scheduler.init_res=100', '--res_scheduler.final_res=100', '--res_scheduler.test_res=100', '--run.gpu_id=0', '--run.n_epochs=50', '--run.random_state=59', '--run.fp16=False', '--model.name=MetaCoupler', '--model.adjoint_mode=ceviche', '--model.sim_cfg.adjoint_mode=ceviche', '--model.mfs=0.1', '--model.build_method=level_set', '--model.max_num_ridges_single_side=50', '--model.initial_point=None', '--model.binary_projection_threshold=20', '--model.subpx_smoothing_res=1000', '--model.if_constant_period=True', '--model.focal_constant=1', '--model.sim_cfg.resolution=100', '--model.sim_cfg.port_len=[2, 2]', '--model.sim_cfg.port_width=[6, 3]', '--model.sim_cfg.border_width=(0, 1)', '--model.constant_period=0.2', '--model.ridge_height_max=0.75', '--model.sub_height=1', '--model.num_layers=5', '--model.sub_height=0', '--model.aperture=6', '--checkpoint.comment=bi_layer_metalens', '--plot.train=True', '--plot.test=False', '--plot.valid=False', '--plot.output_video=False', '--plot.solve_cw=False', '--plot.phase_profile=False', '--plot.intensity_profile=False', '--plot.phase_intensity_profile_interval=5'][0m
[38;21m2024-09-27 18:13:24,485 - train.py[line:91] - INFO: running command ['python3', 'train_metacoupler.py', 'configs/metacoupler/local_search/train_local_search/train.yml', '--criterion.aux_output_weight=0', '--aux_criterion.curl_loss.weight=0', '--aux_criterion.gap_loss.weight=0', '--aux_criterion.aspect_ratio_loss.weight=0', '--plot.dir_name=metacoupler_train_local_search_2', '--optimizer.lr=0.002', '--optimizer.name=adam', '--lr_scheduler.lr_min=2e-05', '--sharp_scheduler.init_sharp=4', '--sharp_scheduler.final_sharp=20', '--res_scheduler.init_res=100', '--res_scheduler.final_res=100', '--res_scheduler.test_res=100', '--run.gpu_id=0', '--run.n_epochs=50', '--run.random_state=59', '--run.fp16=False', '--model.name=MetaCoupler', '--model.adjoint_mode=ceviche', '--model.sim_cfg.adjoint_mode=ceviche', '--model.mfs=0.1', '--model.build_method=1', '--model.max_num_ridges_single_side=50', '--model.initial_point=None', '--model.binary_projection_threshold=20', '--model.subpx_smoothing_res=1000', '--model.if_constant_period=True', '--model.focal_constant=1', '--model.sim_cfg.resolution=100', '--model.sim_cfg.port_len=[2, 2]', '--model.sim_cfg.port_width=[6, 3]', '--model.sim_cfg.border_width=(0, 1)', '--model.constant_period=0.2', '--model.ridge_height_max=5', '--model.sub_height=1', '--model.num_layers=level_set', '--model.sub_height=0', '--model.aperture=6', '--checkpoint.comment=bi_layer_metalens', '--plot.train=True', '--plot.test=False', '--plot.valid=False', '--plot.output_video=False', '--plot.solve_cw=False', '--plot.phase_profile=False', '--plot.intensity_profile=False', '--plot.phase_intensity_profile_interval=5'][0m
[38;21m2024-09-27 18:13:24,504 - train.py[line:91] - INFO: running command ['python3', 'train_metacoupler.py', 'configs/metacoupler/local_search/train_local_search/train.yml', '--criterion.aux_output_weight=0', '--aux_criterion.curl_loss.weight=0', '--aux_criterion.gap_loss.weight=0', '--aux_criterion.aspect_ratio_loss.weight=0', '--plot.dir_name=metacoupler_train_local_search_3', '--optimizer.lr=0.002', '--optimizer.name=adam', '--lr_scheduler.lr_min=2e-05', '--sharp_scheduler.init_sharp=4', '--sharp_scheduler.final_sharp=20', '--res_scheduler.init_res=100', '--res_scheduler.final_res=100', '--res_scheduler.test_res=100', '--run.gpu_id=1', '--run.n_epochs=50', '--run.random_state=59', '--run.fp16=False', '--model.name=MetaCoupler', '--model.adjoint_mode=ceviche', '--model.sim_cfg.adjoint_mode=ceviche', '--model.mfs=0.1', '--model.build_method=0.5', '--model.max_num_ridges_single_side=50', '--model.initial_point=None', '--model.binary_projection_threshold=20', '--model.subpx_smoothing_res=1000', '--model.if_constant_period=True', '--model.focal_constant=1', '--model.sim_cfg.resolution=100', '--model.sim_cfg.port_len=[2, 2]', '--model.sim_cfg.port_width=[6, 3]', '--model.sim_cfg.border_width=(0, 1)', '--model.constant_period=0.2', '--model.ridge_height_max=10', '--model.sub_height=1', '--model.num_layers=level_set', '--model.sub_height=0', '--model.aperture=6', '--checkpoint.comment=bi_layer_metalens', '--plot.train=True', '--plot.test=False', '--plot.valid=False', '--plot.output_video=False', '--plot.solve_cw=False', '--plot.phase_profile=False', '--plot.intensity_profile=False', '--plot.phase_intensity_profile_interval=5'][0m
multiprocessing.pool.RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 48, in mapstar
    return list(map(*args))
  File "/home/pingchua/projects/Metasurface-Opt/scripts/robust_inverse_design/metalens/train.py", line 21, in task_launcher
    model_name, constant_period, mfs, num_layers, ridge_height_max, build_method, max_num_ridges_single_side, init_point, binary_proj_threshold, focal_const, adjoint_mode, aux_loss, opt_name, gpu_id, lr, init_sharp, final_sharp, res, test_res, epochs, id, comment = args
ValueError: not enough values to unpack (expected 22, got 21)
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pingchua/projects/Metasurface-Opt/scripts/robust_inverse_design/metalens/train.py", line 111, in <module>
    p.map(task_launcher, tasks)
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 367, in map
    return self._map_async(func, iterable, mapstar, chunksize).get()
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 774, in get
    raise self._value
ValueError: not enough values to unpack (expected 22, got 21)
[38;21m2024-09-27 18:13:52,000 - train.py[line:91] - INFO: running command ['python3', 'train_metacoupler.py', 'configs/metacoupler/local_search/train_local_search/train.yml', '--criterion.aux_output_weight=0', '--aux_criterion.curl_loss.weight=0', '--aux_criterion.gap_loss.weight=0', '--aux_criterion.aspect_ratio_loss.weight=0', '--plot.dir_name=metacoupler_train_local_search_2', '--optimizer.lr=0.002', '--optimizer.name=adam', '--lr_scheduler.lr_min=2e-05', '--sharp_scheduler.init_sharp=4', '--sharp_scheduler.final_sharp=20', '--res_scheduler.init_res=100', '--res_scheduler.final_res=100', '--res_scheduler.test_res=100', '--run.gpu_id=0', '--run.n_epochs=50', '--run.random_state=59', '--run.fp16=False', '--model.name=MetaCoupler', '--model.adjoint_mode=ceviche', '--model.sim_cfg.adjoint_mode=ceviche', '--model.mfs=0.1', '--model.build_method=1', '--model.max_num_ridges_single_side=50', '--model.initial_point=None', '--model.binary_projection_threshold=20', '--model.subpx_smoothing_res=1000', '--model.if_constant_period=True', '--model.focal_constant=1', '--model.sim_cfg.resolution=100', '--model.sim_cfg.port_len=[2, 2]', '--model.sim_cfg.port_width=[6, 3]', '--model.sim_cfg.border_width=(0, 1)', '--model.constant_period=0.2', '--model.ridge_height_max=5', '--model.sub_height=1', '--model.num_layers=level_set', '--model.sub_height=0', '--model.aperture=6', '--checkpoint.comment=bi_layer_metalens', '--plot.train=True', '--plot.test=False', '--plot.valid=False', '--plot.output_video=False', '--plot.solve_cw=False', '--plot.phase_profile=False', '--plot.intensity_profile=False', '--plot.phase_intensity_profile_interval=5'][0m
[38;21m2024-09-27 18:13:52,011 - train.py[line:91] - INFO: running command ['python3', 'train_metacoupler.py', 'configs/metacoupler/local_search/train_local_search/train.yml', '--criterion.aux_output_weight=0', '--aux_criterion.curl_loss.weight=0', '--aux_criterion.gap_loss.weight=0', '--aux_criterion.aspect_ratio_loss.weight=0', '--plot.dir_name=metacoupler_train_local_search_3', '--optimizer.lr=0.002', '--optimizer.name=adam', '--lr_scheduler.lr_min=2e-05', '--sharp_scheduler.init_sharp=4', '--sharp_scheduler.final_sharp=20', '--res_scheduler.init_res=100', '--res_scheduler.final_res=100', '--res_scheduler.test_res=100', '--run.gpu_id=1', '--run.n_epochs=50', '--run.random_state=59', '--run.fp16=False', '--model.name=MetaCoupler', '--model.adjoint_mode=ceviche', '--model.sim_cfg.adjoint_mode=ceviche', '--model.mfs=0.1', '--model.build_method=0.5', '--model.max_num_ridges_single_side=50', '--model.initial_point=None', '--model.binary_projection_threshold=20', '--model.subpx_smoothing_res=1000', '--model.if_constant_period=True', '--model.focal_constant=1', '--model.sim_cfg.resolution=100', '--model.sim_cfg.port_len=[2, 2]', '--model.sim_cfg.port_width=[6, 3]', '--model.sim_cfg.border_width=(0, 1)', '--model.constant_period=0.2', '--model.ridge_height_max=10', '--model.sub_height=1', '--model.num_layers=level_set', '--model.sub_height=0', '--model.aperture=6', '--checkpoint.comment=bi_layer_metalens', '--plot.train=True', '--plot.test=False', '--plot.valid=False', '--plot.output_video=False', '--plot.solve_cw=False', '--plot.phase_profile=False', '--plot.intensity_profile=False', '--plot.phase_intensity_profile_interval=5'][0m
multiprocessing.pool.RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 48, in mapstar
    return list(map(*args))
  File "/home/pingchua/projects/Metasurface-Opt/scripts/robust_inverse_design/metalens/train.py", line 21, in task_launcher
    model_name, constant_period, mfs, num_layers, ridge_height_max, build_method, max_num_ridges_single_side, init_point, binary_proj_threshold, focal_const, adjoint_mode, aux_loss, opt_name, gpu_id, lr, init_sharp, final_sharp, res, test_res, epochs, id, comment = args
ValueError: not enough values to unpack (expected 22, got 21)
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pingchua/projects/Metasurface-Opt/scripts/robust_inverse_design/metalens/train.py", line 111, in <module>
    p.map(task_launcher, tasks)
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 367, in map
    return self._map_async(func, iterable, mapstar, chunksize).get()
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 774, in get
    raise self._value
ValueError: not enough values to unpack (expected 22, got 21)
[38;21m2024-09-27 18:15:04,405 - train.py[line:91] - INFO: running command ['python3', 'train_metacoupler.py', 'configs/metacoupler/local_search/train_local_search/train.yml', '--criterion.aux_output_weight=0', '--aux_criterion.curl_loss.weight=0', '--aux_criterion.gap_loss.weight=0', '--aux_criterion.aspect_ratio_loss.weight=0', '--plot.dir_name=metacoupler_train_local_search_2', '--optimizer.lr=0.002', '--optimizer.name=adam', '--lr_scheduler.lr_min=2e-05', '--sharp_scheduler.init_sharp=4', '--sharp_scheduler.final_sharp=20', '--res_scheduler.init_res=100', '--res_scheduler.final_res=100', '--res_scheduler.test_res=100', '--run.gpu_id=0', '--run.n_epochs=50', '--run.random_state=59', '--run.fp16=False', '--model.name=MetaCoupler', '--model.adjoint_mode=ceviche', '--model.sim_cfg.adjoint_mode=ceviche', '--model.mfs=0.1', '--model.build_method=level_set', '--model.max_num_ridges_single_side=50', '--model.initial_point=None', '--model.binary_projection_threshold=20', '--model.subpx_smoothing_res=1000', '--model.if_constant_period=True', '--model.focal_constant=1', '--model.sim_cfg.resolution=100', '--model.sim_cfg.port_len=[2, 2]', '--model.sim_cfg.port_width=[6, 3]', '--model.sim_cfg.border_width=(0, 1)', '--model.constant_period=0.2', '--model.ridge_height_max=1', '--model.sub_height=1', '--model.num_layers=5', '--model.sub_height=0', '--model.aperture=6', '--checkpoint.comment=bi_layer_metalens', '--plot.train=True', '--plot.test=False', '--plot.valid=False', '--plot.output_video=False', '--plot.solve_cw=False', '--plot.phase_profile=False', '--plot.intensity_profile=False', '--plot.phase_intensity_profile_interval=5'][0m
[38;21m2024-09-27 18:15:04,416 - train.py[line:91] - INFO: running command ['python3', 'train_metacoupler.py', 'configs/metacoupler/local_search/train_local_search/train.yml', '--criterion.aux_output_weight=0', '--aux_criterion.curl_loss.weight=0', '--aux_criterion.gap_loss.weight=0', '--aux_criterion.aspect_ratio_loss.weight=0', '--plot.dir_name=metacoupler_train_local_search_3', '--optimizer.lr=0.002', '--optimizer.name=adam', '--lr_scheduler.lr_min=2e-05', '--sharp_scheduler.init_sharp=4', '--sharp_scheduler.final_sharp=20', '--res_scheduler.init_res=100', '--res_scheduler.final_res=100', '--res_scheduler.test_res=100', '--run.gpu_id=1', '--run.n_epochs=50', '--run.random_state=59', '--run.fp16=False', '--model.name=MetaCoupler', '--model.adjoint_mode=ceviche', '--model.sim_cfg.adjoint_mode=ceviche', '--model.mfs=0.1', '--model.build_method=level_set', '--model.max_num_ridges_single_side=50', '--model.initial_point=None', '--model.binary_projection_threshold=20', '--model.subpx_smoothing_res=1000', '--model.if_constant_period=True', '--model.focal_constant=1', '--model.sim_cfg.resolution=100', '--model.sim_cfg.port_len=[2, 2]', '--model.sim_cfg.port_width=[6, 3]', '--model.sim_cfg.border_width=(0, 1)', '--model.constant_period=0.2', '--model.ridge_height_max=0.5', '--model.sub_height=1', '--model.num_layers=10', '--model.sub_height=0', '--model.aperture=6', '--checkpoint.comment=bi_layer_metalens', '--plot.train=True', '--plot.test=False', '--plot.valid=False', '--plot.output_video=False', '--plot.solve_cw=False', '--plot.phase_profile=False', '--plot.intensity_profile=False', '--plot.phase_intensity_profile_interval=5'][0m
[38;21m2024-09-27 18:37:12,237 - train.py[line:108] - INFO: Exp: metalens_local_search Done.[0m
multiprocessing.pool.RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 48, in mapstar
    return list(map(*args))
  File "/home/pingchua/projects/Metasurface-Opt/scripts/robust_inverse_design/metalens/train.py", line 21, in task_launcher
    model_name, constant_period, mfs, num_layers, ridge_height_max, build_method, max_num_ridges_single_side, init_point, binary_proj_threshold, focal_const, adjoint_mode, aux_loss, opt_name, gpu_id, lr, init_sharp, final_sharp, res, test_res, epochs, id, comment = args
ValueError: not enough values to unpack (expected 22, got 21)
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pingchua/projects/Metasurface-Opt/scripts/robust_inverse_design/metalens/train.py", line 111, in <module>
    p.map(task_launcher, tasks)
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 367, in map
    return self._map_async(func, iterable, mapstar, chunksize).get()
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 774, in get
    raise self._value
ValueError: not enough values to unpack (expected 22, got 21)
multiprocessing.pool.RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 48, in mapstar
    return list(map(*args))
  File "/home/pingchua/projects/Metasurface-Opt/scripts/robust_inverse_design/metalens/train.py", line 21, in task_launcher
    model_name, aperture, sub_height, constant_period, mfs, num_layers, ridge_height_max, build_method, max_num_ridges_single_side, init_point, binary_proj_threshold, focal_const, adjoint_mode, aux_loss, opt_name, gpu_id, lr, init_sharp, final_sharp, res, test_res, epochs, id, comment = args
ValueError: not enough values to unpack (expected 24, got 23)
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/pingchua/projects/Metasurface-Opt/scripts/robust_inverse_design/metalens/train.py", line 110, in <module>
    p.map(task_launcher, tasks)
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 367, in map
    return self._map_async(func, iterable, mapstar, chunksize).get()
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 774, in get
    raise self._value
ValueError: not enough values to unpack (expected 24, got 23)
[38;21m2024-09-27 18:56:49,257 - train.py[line:90] - INFO: running command ['python3', 'train_metacoupler.py', 'configs/metacoupler/local_search/train_local_search/train.yml', '--criterion.aux_output_weight=0', '--aux_criterion.curl_loss.weight=0', '--aux_criterion.gap_loss.weight=0', '--aux_criterion.aspect_ratio_loss.weight=0', '--plot.dir_name=metacoupler_train_local_search_4', '--optimizer.lr=0.002', '--optimizer.name=adam', '--lr_scheduler.lr_min=2e-05', '--sharp_scheduler.init_sharp=4', '--sharp_scheduler.final_sharp=20', '--res_scheduler.init_res=100', '--res_scheduler.final_res=100', '--res_scheduler.test_res=100', '--run.gpu_id=2', '--run.n_epochs=50', '--run.random_state=59', '--run.fp16=False', '--model.name=MetaCoupler', '--model.adjoint_mode=ceviche', '--model.sim_cfg.adjoint_mode=ceviche', '--model.mfs=0.1', '--model.build_method=level_set', '--model.max_num_ridges_single_side=50', '--model.initial_point=None', '--model.binary_projection_threshold=20', '--model.subpx_smoothing_res=1000', '--model.if_constant_period=True', '--model.focal_constant=1', '--model.sim_cfg.resolution=100', '--model.sim_cfg.port_len=[2, 2]', '--model.sim_cfg.port_width=[6, 3]', '--model.sim_cfg.border_width=(0, 1)', '--model.constant_period=0.2', '--model.ridge_height_max=2', '--model.num_layers=2', '--model.sub_height=0', '--model.aperture=6', '--checkpoint.comment=bi_layer_metalens', '--plot.train=True', '--plot.test=False', '--plot.valid=False', '--plot.output_video=False', '--plot.solve_cw=False', '--plot.phase_profile=False', '--plot.intensity_profile=False', '--plot.phase_intensity_profile_interval=5'][0m
[38;21m2024-09-27 18:56:49,260 - train.py[line:90] - INFO: running command ['python3', 'train_metacoupler.py', 'configs/metacoupler/local_search/train_local_search/train.yml', '--criterion.aux_output_weight=0', '--aux_criterion.curl_loss.weight=0', '--aux_criterion.gap_loss.weight=0', '--aux_criterion.aspect_ratio_loss.weight=0', '--plot.dir_name=metacoupler_train_local_search_5', '--optimizer.lr=0.002', '--optimizer.name=adam', '--lr_scheduler.lr_min=2e-05', '--sharp_scheduler.init_sharp=4', '--sharp_scheduler.final_sharp=20', '--res_scheduler.init_res=100', '--res_scheduler.final_res=100', '--res_scheduler.test_res=100', '--run.gpu_id=3', '--run.n_epochs=50', '--run.random_state=59', '--run.fp16=False', '--model.name=MetaCoupler', '--model.adjoint_mode=ceviche', '--model.sim_cfg.adjoint_mode=ceviche', '--model.mfs=0.1', '--model.build_method=level_set', '--model.max_num_ridges_single_side=50', '--model.initial_point=None', '--model.binary_projection_threshold=20', '--model.subpx_smoothing_res=1000', '--model.if_constant_period=True', '--model.focal_constant=1', '--model.sim_cfg.resolution=100', '--model.sim_cfg.port_len=[2, 2]', '--model.sim_cfg.port_width=[6, 3]', '--model.sim_cfg.border_width=(0, 1)', '--model.constant_period=0.2', '--model.ridge_height_max=0.4', '--model.num_layers=15', '--model.sub_height=0', '--model.aperture=6', '--checkpoint.comment=bi_layer_metalens', '--plot.train=True', '--plot.test=False', '--plot.valid=False', '--plot.output_video=False', '--plot.solve_cw=False', '--plot.phase_profile=False', '--plot.intensity_profile=False', '--plot.phase_intensity_profile_interval=5'][0m
[38;21m2024-09-27 19:32:02,833 - train.py[line:111] - INFO: Exp: metalens_local_search Done.[0m
[38;21m2024-09-28 00:17:17,286 - train.py[line:90] - INFO: running command ['python3', 'train_metacoupler.py', 'configs/metacoupler/local_search/train_local_search/train.yml', '--criterion.aux_output_weight=0', '--aux_criterion.curl_loss.weight=0', '--aux_criterion.gap_loss.weight=0', '--aux_criterion.aspect_ratio_loss.weight=0', '--plot.dir_name=metacoupler_train_local_search_6', '--optimizer.lr=0.002', '--optimizer.name=adam', '--lr_scheduler.lr_min=2e-05', '--sharp_scheduler.init_sharp=4', '--sharp_scheduler.final_sharp=20', '--res_scheduler.init_res=100', '--res_scheduler.final_res=100', '--res_scheduler.test_res=100', '--run.gpu_id=0', '--run.n_epochs=50', '--run.random_state=59', '--run.fp16=False', '--model.name=MetaCoupler', '--model.adjoint_mode=ceviche', '--model.sim_cfg.adjoint_mode=ceviche', '--model.mfs=0.1', '--model.build_method=level_set', '--model.max_num_ridges_single_side=50', '--model.initial_point=None', '--model.binary_projection_threshold=20', '--model.subpx_smoothing_res=1000', '--model.if_constant_period=True', '--model.focal_constant=1', '--model.sim_cfg.resolution=100', '--model.sim_cfg.port_len=[2, 2]', '--model.sim_cfg.port_width=[6, 3]', '--model.sim_cfg.border_width=(0, 1)', '--model.constant_period=0.2', '--model.ridge_height_max=0.4', '--model.num_layers=15', '--model.sub_height=0', '--model.aperture=6', '--checkpoint.comment=debug', '--plot.train=True', '--plot.test=False', '--plot.valid=False', '--plot.output_video=False', '--plot.solve_cw=False', '--plot.phase_profile=False', '--plot.intensity_profile=False', '--plot.phase_intensity_profile_interval=5'][0m
[38;21m2024-09-28 00:17:41,119 - train.py[line:112] - INFO: Exp: metalens_local_search Done.[0m
[38;21m2024-09-28 00:18:17,669 - train.py[line:90] - INFO: running command ['python3', 'train_metacoupler.py', 'configs/metacoupler/local_search/train_local_search/train.yml', '--criterion.aux_output_weight=0', '--aux_criterion.curl_loss.weight=0', '--aux_criterion.gap_loss.weight=0', '--aux_criterion.aspect_ratio_loss.weight=0', '--plot.dir_name=metacoupler_train_local_search_6', '--optimizer.lr=0.002', '--optimizer.name=adam', '--lr_scheduler.lr_min=2e-05', '--sharp_scheduler.init_sharp=4', '--sharp_scheduler.final_sharp=20', '--res_scheduler.init_res=100', '--res_scheduler.final_res=100', '--res_scheduler.test_res=100', '--run.gpu_id=0', '--run.n_epochs=50', '--run.random_state=59', '--run.fp16=False', '--model.name=MetaCoupler', '--model.adjoint_mode=ceviche', '--model.sim_cfg.adjoint_mode=ceviche', '--model.mfs=0.1', '--model.build_method=level_set', '--model.max_num_ridges_single_side=50', '--model.initial_point=None', '--model.binary_projection_threshold=20', '--model.subpx_smoothing_res=1000', '--model.if_constant_period=True', '--model.focal_constant=1', '--model.sim_cfg.resolution=100', '--model.sim_cfg.port_len=[2, 2]', '--model.sim_cfg.port_width=[6, 3]', '--model.sim_cfg.border_width=(0, 1)', '--model.constant_period=0.2', '--model.ridge_height_max=0.4', '--model.num_layers=15', '--model.sub_height=0', '--model.aperture=6', '--checkpoint.comment=debug', '--plot.train=True', '--plot.test=False', '--plot.valid=False', '--plot.output_video=False', '--plot.solve_cw=False', '--plot.phase_profile=False', '--plot.intensity_profile=False', '--plot.phase_intensity_profile_interval=5'][0m
Process ForkPoolWorker-2:
Process ForkPoolWorker-4:
Process ForkPoolWorker-3:
Traceback (most recent call last):
  File "/home/pingchua/projects/Metasurface-Opt/scripts/robust_inverse_design/metalens/train.py", line 111, in <module>
    p.map(task_launcher, tasks)
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 367, in map
    return self._map_async(func, iterable, mapstar, chunksize).get()
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 768, in get
    self.wait(timeout)
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 765, in wait
    self._event.wait(timeout)
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/threading.py", line 607, in wait
    signaled = self._cond.wait(timeout)
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt
[38;21m2024-09-28 00:34:01,723 - train.py[line:90] - INFO: running command ['python3', 'train_metacoupler.py', 'configs/metacoupler/local_search/train_local_search/train.yml', '--criterion.aux_output_weight=0', '--aux_criterion.curl_loss.weight=0', '--aux_criterion.gap_loss.weight=0', '--aux_criterion.aspect_ratio_loss.weight=0', '--plot.dir_name=metacoupler_train_local_search_6', '--optimizer.lr=0.002', '--optimizer.name=adam', '--lr_scheduler.lr_min=2e-05', '--sharp_scheduler.init_sharp=4', '--sharp_scheduler.final_sharp=20', '--res_scheduler.init_res=100', '--res_scheduler.final_res=100', '--res_scheduler.test_res=100', '--run.gpu_id=0', '--run.n_epochs=50', '--run.random_state=59', '--run.fp16=False', '--model.name=MetaCoupler', '--model.adjoint_mode=ceviche', '--model.sim_cfg.adjoint_mode=ceviche', '--model.mfs=0.1', '--model.build_method=level_set', '--model.max_num_ridges_single_side=50', '--model.initial_point=None', '--model.binary_projection_threshold=20', '--model.subpx_smoothing_res=1000', '--model.if_constant_period=True', '--model.focal_constant=1', '--model.sim_cfg.resolution=100', '--model.sim_cfg.port_len=[2, 2]', '--model.sim_cfg.port_width=[6, 3]', '--model.sim_cfg.border_width=(0, 1)', '--model.constant_period=0.2', '--model.ridge_height_max=0.4', '--model.num_layers=15', '--model.sub_height=0', '--model.aperture=6', '--checkpoint.comment=debug', '--plot.train=True', '--plot.test=False', '--plot.valid=False', '--plot.output_video=False', '--plot.solve_cw=False', '--plot.phase_profile=False', '--plot.intensity_profile=False', '--plot.phase_intensity_profile_interval=5'][0m
[38;21m2024-09-28 00:34:45,543 - train.py[line:112] - INFO: Exp: metalens_local_search Done.[0m
[38;21m2024-09-28 00:37:53,677 - train.py[line:90] - INFO: running command ['python3', 'train_metacoupler.py', 'configs/metacoupler/local_search/train_local_search/train.yml', '--criterion.aux_output_weight=0', '--aux_criterion.curl_loss.weight=0', '--aux_criterion.gap_loss.weight=0', '--aux_criterion.aspect_ratio_loss.weight=0', '--plot.dir_name=metacoupler_train_local_search_6', '--optimizer.lr=0.002', '--optimizer.name=adam', '--lr_scheduler.lr_min=2e-05', '--sharp_scheduler.init_sharp=4', '--sharp_scheduler.final_sharp=20', '--res_scheduler.init_res=100', '--res_scheduler.final_res=100', '--res_scheduler.test_res=100', '--run.gpu_id=0', '--run.n_epochs=50', '--run.random_state=59', '--run.fp16=False', '--model.name=MetaCoupler', '--model.adjoint_mode=ceviche', '--model.sim_cfg.adjoint_mode=ceviche', '--model.mfs=0.1', '--model.build_method=level_set', '--model.max_num_ridges_single_side=50', '--model.initial_point=None', '--model.binary_projection_threshold=20', '--model.subpx_smoothing_res=1000', '--model.if_constant_period=True', '--model.focal_constant=1', '--model.sim_cfg.resolution=100', '--model.sim_cfg.port_len=[2, 2]', '--model.sim_cfg.port_width=[6, 3]', '--model.sim_cfg.border_width=(0, 1)', '--model.constant_period=0.2', '--model.ridge_height_max=0.4', '--model.num_layers=15', '--model.sub_height=0', '--model.aperture=6', '--checkpoint.comment=debug', '--plot.train=True', '--plot.test=False', '--plot.valid=False', '--plot.output_video=False', '--plot.solve_cw=False', '--plot.phase_profile=False', '--plot.intensity_profile=False', '--plot.phase_intensity_profile_interval=5'][0m
Process ForkPoolWorker-2:
Process ForkPoolWorker-3:
Process ForkPoolWorker-4:
Traceback (most recent call last):
  File "/home/pingchua/projects/Metasurface-Opt/scripts/robust_inverse_design/metalens/train.py", line 111, in <module>
    p.map(task_launcher, tasks)
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 367, in map
    return self._map_async(func, iterable, mapstar, chunksize).get()
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 768, in get
    self.wait(timeout)
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/multiprocessing/pool.py", line 765, in wait
    self._event.wait(timeout)
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/threading.py", line 607, in wait
    signaled = self._cond.wait(timeout)
  File "/home/jiaqigu/pkgs/miniforge3/envs/python310venv/lib/python3.10/threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt
[38;21m2024-09-28 00:47:04,981 - train.py[line:90] - INFO: running command ['python3', 'train_metacoupler.py', 'configs/metacoupler/local_search/train_local_search/train.yml', '--criterion.aux_output_weight=0', '--aux_criterion.curl_loss.weight=0', '--aux_criterion.gap_loss.weight=0', '--aux_criterion.aspect_ratio_loss.weight=0', '--plot.dir_name=metacoupler_train_local_search_6', '--optimizer.lr=0.002', '--optimizer.name=adam', '--lr_scheduler.lr_min=2e-05', '--sharp_scheduler.init_sharp=4', '--sharp_scheduler.final_sharp=20', '--res_scheduler.init_res=100', '--res_scheduler.final_res=100', '--res_scheduler.test_res=100', '--run.gpu_id=0', '--run.n_epochs=50', '--run.random_state=59', '--run.fp16=False', '--model.name=MetaCoupler', '--model.adjoint_mode=ceviche', '--model.sim_cfg.adjoint_mode=ceviche', '--model.mfs=0.1', '--model.build_method=level_set', '--model.max_num_ridges_single_side=50', '--model.initial_point=None', '--model.binary_projection_threshold=20', '--model.subpx_smoothing_res=1000', '--model.if_constant_period=True', '--model.focal_constant=1', '--model.sim_cfg.resolution=100', '--model.sim_cfg.port_len=[2, 2]', '--model.sim_cfg.port_width=[6, 3]', '--model.sim_cfg.border_width=(0, 1)', '--model.constant_period=0.2', '--model.ridge_height_max=0.4', '--model.num_layers=15', '--model.sub_height=0', '--model.aperture=6', '--checkpoint.comment=debug', '--plot.train=True', '--plot.test=False', '--plot.valid=False', '--plot.output_video=False', '--plot.solve_cw=False', '--plot.phase_profile=False', '--plot.intensity_profile=False', '--plot.phase_intensity_profile_interval=5'][0m
[38;21m2024-09-28 00:47:58,798 - train.py[line:112] - INFO: Exp: metalens_local_search Done.[0m
[38;21m2024-09-28 00:50:09,530 - train.py[line:90] - INFO: running command ['python3', 'train_metacoupler.py', 'configs/metacoupler/local_search/train_local_search/train.yml', '--criterion.aux_output_weight=0', '--aux_criterion.curl_loss.weight=0', '--aux_criterion.gap_loss.weight=0', '--aux_criterion.aspect_ratio_loss.weight=0', '--plot.dir_name=metacoupler_train_local_search_6', '--optimizer.lr=0.002', '--optimizer.name=adam', '--lr_scheduler.lr_min=2e-05', '--sharp_scheduler.init_sharp=4', '--sharp_scheduler.final_sharp=20', '--res_scheduler.init_res=100', '--res_scheduler.final_res=100', '--res_scheduler.test_res=100', '--run.gpu_id=0', '--run.n_epochs=50', '--run.random_state=59', '--run.fp16=False', '--model.name=MetaCoupler', '--model.adjoint_mode=ceviche', '--model.sim_cfg.adjoint_mode=ceviche', '--model.mfs=0.1', '--model.build_method=level_set', '--model.max_num_ridges_single_side=50', '--model.initial_point=None', '--model.binary_projection_threshold=20', '--model.subpx_smoothing_res=1000', '--model.if_constant_period=True', '--model.focal_constant=1', '--model.sim_cfg.resolution=100', '--model.sim_cfg.port_len=[2, 2]', '--model.sim_cfg.port_width=[6, 3]', '--model.sim_cfg.border_width=(0, 1)', '--model.constant_period=0.2', '--model.ridge_height_max=0.4', '--model.num_layers=15', '--model.sub_height=0', '--model.aperture=6', '--checkpoint.comment=debug', '--plot.train=True', '--plot.test=False', '--plot.valid=False', '--plot.output_video=False', '--plot.solve_cw=False', '--plot.phase_profile=False', '--plot.intensity_profile=False', '--plot.phase_intensity_profile_interval=5'][0m
[38;21m2024-09-28 00:50:45,424 - train.py[line:112] - INFO: Exp: metalens_local_search Done.[0m
[38;21m2024-09-28 22:19:01,518 - train.py[line:90] - INFO: running command ['python3', 'train_metacoupler.py', 'configs/metacoupler/local_search/train_local_search/train.yml', '--criterion.aux_output_weight=0', '--aux_criterion.curl_loss.weight=0', '--aux_criterion.gap_loss.weight=0', '--aux_criterion.aspect_ratio_loss.weight=0', '--plot.dir_name=metacoupler_train_local_search_7', '--optimizer.lr=0.002', '--optimizer.name=adam', '--lr_scheduler.lr_min=2e-05', '--sharp_scheduler.init_sharp=4', '--sharp_scheduler.final_sharp=20', '--res_scheduler.init_res=100', '--res_scheduler.final_res=100', '--res_scheduler.test_res=100', '--run.gpu_id=3', '--run.n_epochs=50', '--run.random_state=59', '--run.fp16=False', '--model.name=MetaCoupler', '--model.adjoint_mode=ceviche', '--model.sim_cfg.adjoint_mode=ceviche', '--model.mfs=0.1', '--model.build_method=level_set', '--model.max_num_ridges_single_side=50', '--model.initial_point=None', '--model.binary_projection_threshold=20', '--model.subpx_smoothing_res=1000', '--model.if_constant_period=True', '--model.focal_constant=1', '--model.sim_cfg.resolution=100', '--model.sim_cfg.port_len=[2, 2]', '--model.sim_cfg.port_width=[6, 3]', '--model.sim_cfg.border_width=(0, 0.5)', '--model.constant_period=0.2', '--model.ridge_height_max=0.4', '--model.num_layers=30', '--model.sub_height=0', '--model.aperture=6', '--checkpoint.comment=bi_layer_metalens', '--plot.train=True', '--plot.test=False', '--plot.valid=False', '--plot.output_video=False', '--plot.solve_cw=False', '--plot.phase_profile=False', '--plot.intensity_profile=False', '--plot.phase_intensity_profile_interval=5'][0m
[38;21m2024-09-28 22:43:45,260 - train.py[line:113] - INFO: Exp: metalens_local_search Done.[0m
